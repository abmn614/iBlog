<extend name="./Public/Admin/base.html" />

<block name="page_tool">
    <div class="btn-group" style="margin-right: 400px;">
        <a href="{ :U('Post/index') }" class="btn btn-primary">所有</a>
        <a href="{ :U('Post/index', ['status' => 1]) }" class="btn btn-primary">已锁定</a>
        <a href="{ :U('Post/index', ['status' => 2]) }" class="btn btn-primary">已删除</a>
    </div>
    <a href="{ :U('Post/postAdd') }" class="btn btn-primary">发表文章</a>
</block>

<block name="content">
    <div class="panel panel-primary">
        <div class="panel-body panel-body-table">
            <table class="table datatable table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>分类</th>
                        <th>标题</th>
                        <th>Tag</th>
                        <th>状态</th>
                        <th>点击</th>
                        <th>作者</th>
                        <th>创建时间</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    <volist name="posts" id="post">
                    <tr>
                        <td>{ $post.id }</td>
                        <td>{ $post.cate }</td>
                        <td>{ $post.title }</td>
                        <td>
                            <foreach name="post.tag" item="tag">
                                <span class="label label-success">{ $tag.name }</span>&nbsp;
                            </foreach>
                        </td>
                        <td>
                            <if condition = "$post['status'] eq 0">正常
                            <elseif condition = "$post['status'] eq 1" /><span class="text-warning">已锁定</span>
                            <elseif condition="$post['status'] eq 2" /><span class="text-danger">已删除</span>
                            <else />{ $post.status }
                            </if>
                        </td>
                        <td>{ $post.click }</td>
                        <td>
                            <if condition="$post['nickname'] eq ''">
                                { $post.username }
                            <else />
                                { $post.nickname }
                            </if>
                        </td>
                        <td>{ $post.create_time }</td>
                        <td>
                            <a href="{ :U('Post/postAlter', ['id' => $post['id']]) }" class="text-info" title="修改"><i class="glyphicon glyphicon-edit"></i></a> 
                            <if condition = "$post['status'] eq 0">
                                <a href="{ :U('Post/lockDo', ['id' => $post['id'], 'status' => 1]) }" class="text-warning lock" title="锁定"><i class="fa fa-lock"></i></a>
                            <elseif condition="$post['status'] eq 1" />
                                <a href="{ :U('Post/lockDo', ['id' => $post['id'], 'status' => 0]) }" class="text-warning lock" title="解锁"><i class="fa fa-unlock"></i></a>
                            </if>
                            <a href="{ :U('Post/postDelDo', ['id' => $post['id']]) }" class="text-danger del" title="删除"><i class="fa fa-trash-o"></i></a>
                        </td>
                    </tr>
                    </volist>
                </tbody>
            </table>
        </div>
    </div>
</block>

<block name="js">
    <script>
    $(".del, .lock").click(function(){
        if (!confirm('确认要进行这个操作吗？')) {
            return false;
        }
    });
    </script>
</block>

<block name="page_plugins">
    <script type="text/javascript" src="{ $Think.config.Public }js/plugins/datatables/jquery.dataTables.min.js"></script>    
</block>

